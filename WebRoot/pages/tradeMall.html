<div id="page_tradeMall">
	<link rel='stylesheet' type='text/css' href='css/tradeMall.css'>
	<div class='content'>
		<div class="top">
			<div class="logo"><img src="css/images/logo.jpg"></div>
		</div>
		<div class="list">
			<div class="item">
				<div class="itemTop">
					<div class="nickName left clearfix">HH</div>
					<div class="postTime right clearfix">2014-3-1</div>
				</div>
				<div class="thingName">机械键盘</div>
				<div class="intro">这是刚刚用过不久的机械键盘，当初买成45块钱。</div>
				<div class="thingImg"><img src="css/images/logo.jpg"/></div>
			</div>
		</div>
		<div class="list">
			<div class="item">
				<div class="itemTop">
					<div class="nickName left clearfix">HH</div>
					<div class="postTime right clearfix">2014-3-1</div>
				</div>
				<div class="thingName">机械键盘</div>
				<div class="intro">这是刚刚用过不久的机械键盘，当初买成45块钱。</div>
				<div class="thingImg"><img src="css/images/logo.jpg"/></div>
			</div>
		</div>
		<div class="list">
			<div class="item">
				<div class="itemTop">
					<div class="nickName left clearfix">HH</div>
					<div class="postTime right clearfix">2014-3-1</div>
				</div>
				<div class="thingName">机械键盘</div>
				<div class="intro">这是刚刚用过不久的机械键盘，当初买成45块钱。</div>
				<div class="thingImg"><img src="css/images/logo.jpg"/></div>
			</div>
		</div>
		<div class='more' onclick='page_tradeMall.nextPage()' style="display: none;">更多</div>
	</div>
	<script type="text/javascript">
		var page_tradeMall = {
			init:function(){
				page_tradeMall.refresh();
			},
			beforeshow: function(){
				$InterAction.setHeader("易物城","","refresh");
				setActiveBtn(0);
				showFooter();
			},
			refresh:function(){
				var config = GLOBAL_CONFIG.tradeMall;
				config.pageno = 1;
				config.total = 0;
				config.itemCnt = 0;
				//$('#page_tradeMall .content .list').empty();
				page_tradeMall.nextPage();
			},
			nextPage:function(){
				var me = page_tradeMall,
					config = GLOBAL_CONFIG.tradeMall;
				$('#page_tradeMall .more').hide();
				$MsgBox.showLoading();
				$.jsonp({
					url:GLOBAL.baseUrl + "/fashion/fashionMobi_getbycompany.action",
					callback:'callback',
					data:{
						companyId:GLOBAL.companyId,
						page:config.pageno,
						rows:config.rows
					},
					complete: function(json,t){$MsgBox.hideLoading();},
					success: function(data){
						if(data && data.result.rows.length>0){
							if(config.pageno == 1){
								config.total = data.total;
							}
							var rows = data.result.rows,
								len = rows.length,
								str = '';
							for(var i = 0; i < len; i++){
								str+="<div class='top'><div class='logo'><img src='css/images/logo.jpg'></div></div>"
								+ "<div class='list'>"
								+ "<div class='item'>"
								+ "<div class='itemTop'>"
								+ "<div class='nickName'>" + rows[i].nickName +  "</div>"
								+ "<div class='postTime'>" + rows[i].postTime + "</div>" 
								+ "</div>"
								+ "<div class='thingName'>" + rows[i].thingName + "</div>"
								+ "<div class='intro'>" + rows[i].intro + "</div>"
								+ "<div class='thingImg'><img src='"+rows[i].thingImg+"'></div>"
								+ "</div>"
								+ "</div>"
							}
							config.itemCnt += len;
							if(config.itemCnt < config.total){
								$('#page_tradeMall .more').show();
								config.pageno ++;
							} else {
								$('#page_tradeMall .more').hide();
							}
							$("#page_tradeMall .list").append(str);
						}else if(config.pageno == 1){
							$("#page_tradeMall .content").html('<div align="center"><h2>暂无内容</h2></div>');
						}	
					}
				});
			}
		}
		$('#page_tradeMall').bind('pageinit',page_tradeMall.init)
							.bind('pagebeforeshow', page_tradeMall.beforeshow);
		</script>
	</div>